<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Аналитический анализ</title>
    <style>
        .top-nav {
            position: absolute;
            top: 10px;
            right: 10px;
        }
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
        }
        .section {
            margin-bottom: 20px;
        }
        input[type="text"] {
            width: 300px;
            padding: 5px;
        }
    </style>
</head>
<body>
    <div class="top-nav">
        <a href="/">← Основной график</a> |
        <a href="/instruktion" target="_blank">Инструкция</a>
    </div>

    <h2>Аналитический анализ</h2>

    <!-- Важно: action="/analytical", чтобы POST уходил на правильный маршрут -->
    <form method="post" action="/analytical" enctype="multipart/form-data">
        <div class="section">
    <label><strong>Название графика:</strong>
        <input type="text" name="plot_title"
               value="{{ request.form.plot_title or 'Аналитический анализ' }}"
               style="width: 300px; padding: 5px;">
    </label>
</div>
        <div class="section">
            <h3>Файлы данных (до 3)</h3>
            {% for i in range(1, 4) %}
                <div>
                    Файл {{ i }}:
                    <input type="file" name="file{{ i }}" accept=".xlsx">
                </div>
            {% endfor %}
        </div>

        <div class="section">
            <h3>Аналитические функции (до 2)</h3>
            <p>Используйте <code>x</code> как переменную. Примеры: <code>sin(x)</code>, <code>x**2</code>, <code>2*x + 1</code></p>
            <label>Функция 1 (синяя): <input type="text" name="func1" placeholder="sin(x)"></label><br><br>
            <label>Функция 2 (красная): <input type="text" name="func2" placeholder="x**2"></label>
        </div>

        <button type="submit">Построить график</button>
    </form>

    {% if error %}
        <p style="color: red; background: #ffe6e6; padding: 10px; border-radius: 4px;">
            {{ error }}
        </p>
    {% endif %}

    {% if plot_html %}
        <h3>Результат:</h3>
        {{ plot_html|safe }}
    {% endif %}
</body>
</html>